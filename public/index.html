<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>joojle</title>
  <meta name="description" content="joojle هو محرك بحث ذكي وسريع شبيه بجوجل، يمكنك من خلاله البحث في الويب بسهولة ودقة.">
  <meta name="keywords" content="joojle, joojle search, google alternative, محرك بحث, بحث, بحث عربي, بحث سريع, محرك بحث عربي, بديل جوجل, بحث الويب, بحث ذكي, محرك بحث يشبه Google, جوجل, بحث متقدم">
  <link rel="icon" href="favicon.png" type="image/png">
  <script src="https://unpkg.com/ml5@latest/dist/ml5.min.js"></script>
  <style>
    body { background:#fff; font-family:Arial, sans-serif; margin:0; padding:0; direction:rtl; text-align:center; }
header {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  padding: 12px 20px;
  gap: 15px;
  position: relative;
  direction: rtl;
}

header a {
  text-decoration: none;
  color: #202124;
  font-size: 14px;
}

.apps-container { position: relative; }
.apps-icon {
  width: 40px; height: 40px;
  display: flex; align-items: center; justify-content: center;
  border-radius: 50%; cursor: pointer;
}
.apps-icon:hover { background: rgba(60,64,67,0.1); }
.apps-icon svg { fill: #5f6368; width: 24px; height: 24px; }

.apps-dropdown {
  display: none;
  position: absolute;
  top: 55px;
  left: 10px; 
  width: 320px;
  background: #f8fafd; 
  border-radius: 28px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1), 0 1px 3px rgba(0,0,0,0.08);
  padding: 20px;
  z-index: 2000;
  grid-template-columns: repeat(3, 1fr);
  gap: 15px;
}

.app-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-decoration: none;
  padding: 12px 5px;
  border-radius: 16px;
  transition: background 0.2s;
}

.app-item:hover { background: #eef2fa; }

.app-item img {
  width: 40px;
  height: 40px;
  margin-bottom: 8px;
  object-fit: contain;
}

.app-item span {
  color: #1f1f1f;
  font-size: 12px;
  text-align: center;
  font-weight: 500;
}

.profile-img {
  width: 35px;
  height: 35px;
  border-radius: 50%;
  object-fit: cover;
  background: #e1e1e1;
  cursor: default;
}
    .logo { font-size:92px; font-weight:bold; margin-top:100px; }
    .blue{color:#4285F4} .red{color:#EA4335} .yellow{color:#FBBC05} .green{color:#34A853}
    .search-box { margin:30px auto; width:600px; max-width:90%; }
    .shortcuts { margin-top:30px; display:flex; justify-content:center; gap:40px; flex-wrap:wrap; }
    .shortcut { text-align:center; color:#333; font-size:14px; cursor:pointer; position:relative; }
    .shortcut-circle { width:60px; height:60px; background-color:#ffe8dc; border-radius:50%; display:flex; align-items:center; justify-content:center; margin:0 auto 8px; font-size:24px; }
    .shortcut-circle img { width:30px; }
    .delete-btn { position:absolute; top:-8px; right:-8px; background:red; color:white; border:none; border-radius:50%; width:20px; height:20px; font-size:12px; cursor:pointer; display:none; }
    .shortcut:hover .delete-btn { display:block; }
    .customize { position:fixed; bottom:20px; left:20px; background-color:#ffe8dc; padding:8px 14px; border-radius:999px; font-size:14px; box-shadow:0 1px 4px rgba(0,0,0,0.2); display:flex; align-items:center; gap:5px; cursor:pointer; }
    #results .result-item { max-width:700px; margin:20px auto; text-align:right; border-bottom:1px solid #eee; padding-bottom:15px; }
    #results .result-item img { max-width:100px; max-height:100px; margin-left:10px; vertical-align:middle; }
.search-wrapper {
  display: flex;
  align-items: center;
  gap: 8px; 
  background: #fff;
  border: 1px solid #ddd;
  border-radius: 999px;
  padding: 8px 12px;
  box-shadow: 0 1px 6px rgba(32,33,36,.28);
  max-width: 600px;
  margin: auto;
  box-sizing: border-box;
  width: 100%;
}

.search-wrapper input {
  flex: 1;
  border: none;
  outline: none;
  font-size: 16px;
  padding: 8px;
  direction: rtl;
  background: transparent;
  min-width: 0;
}

.icon-btn {
  background: none;
  border: none;
  cursor: pointer;
  padding: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0; 
}

.icon-btn svg {
  width: 22px;
  height: 22px;
  stroke: #5f6368;
  fill: none;
  stroke-width: 2;
}

.icon-btn:hover svg {
  stroke: #1a73e8;
}

@media (max-width: 480px) {
  .search-wrapper {
    padding: 6px 10px;
    gap: 4px;
  }

  .search-wrapper input {
    font-size: 15px;
    padding: 6px;
  }

  .icon-btn {
    padding: 4px;
  }

  .icon-btn svg {
    width: 18px;
    height: 18px;
  }
}
.customize {
  position: fixed;
  bottom: 15px;
  left: 15px;
  background: #ffe8dc !important;
  color: #000000 !important;
  border: 1px solid #dfe1e5;
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 13px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.1);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  z-index: 999;
}

.modal {
  display: none;
  position: fixed;
  z-index: 1001;
  left: 0; top: 0; width: 100%; height: 100%;
  background-color: rgba(0,0,0,0.6);
}

.modal-content {
  background-color: #ffffff !important;
  color: #202124 !important;
  margin: 5% auto;
  padding: 25px;
  border-radius: 12px;
  width: 90%;
  max-width: 350px;
  text-align: right;
  box-shadow: 0 5px 20px rgba(0,0,0,0.3);
}

.modal-content h3, .modal-content label, .modal-content span {
  color: #202124 !important;
  display: block;
  margin-bottom: 5px;
}

.customize-option { margin-bottom: 15px; }

.input-style {
  width: 100%;
  padding: 8px;
  border: 1px solid #dfe1e5;
  border-radius: 4px;
  box-sizing: border-box;
}

.close-modal {
  background: #1a73e8;
  color: white;
  border: none;
  padding: 10px;
  border-radius: 4px;
  cursor: pointer;
  width: 100%;
  margin-top: 10px;
}
  </style>
</head>
<body>

<header>
  <a href="https://mail.google.com" target="_blank">Gmail</a>
  <a href="images.html">صور</a>
  
  <div class="apps-container">
    <div class="apps-icon" onclick="toggleApps(event)">
<svg viewBox="0 0 24 24">
    <path d="M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zM6 4c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 12c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path>
  </svg>
</div>
    
    <div id="appsMenu" class="apps-dropdown">
      <a href="https://www.google.com" class="app-item">
        <img src="https://upload.wikimedia.org/wikipedia/commons/2/2d/Google-favicon-2015.png" alt="بحث">
        <span>بحث</span>
      </a>
      <a href="https://maps.google.com" class="app-item">
        <img src="https://upload.wikimedia.org/wikipedia/commons/a/aa/Google_Maps_icon_%282020%29.svg" alt="خرائط">
        <span>خرائط</span>
      </a>
      <a href="https://mail.google.com" class="app-item">
        <img src="https://upload.wikimedia.org/wikipedia/commons/7/7e/Gmail_icon_%282020%29.svg" alt="Gmail">
        <span>Gmail</span>
      </a>
      <a href="https://www.youtube.com" class="app-item">
        <img src="https://upload.wikimedia.org/wikipedia/commons/e/ef/Youtube_logo.png" alt="YouTube">
        <span>YouTube</span>
      </a>
      <a href="https://drive.google.com" class="app-item">
        <img src="https://upload.wikimedia.org/wikipedia/commons/1/12/Google_Drive_icon_%282020%29.svg" alt="Drive">
        <span>Drive</span>
      </a>
      <a href="https://gemini.google.com" class="app-item">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8a/Google_Gemini_logo.svg/1024px-Google_Gemini_logo.svg.png" alt="Gemini">
        <span>Gemini</span>
      </a>
      <a href="https://photos.google.com" class="app-item">
        <img src="https://storage.googleapis.com/gweb-uniblog-publish-prod/images/Icon_White_BG.width-500.format-webp.webp" alt="صور">
        <span>صور</span>
      </a>
      <a href="https://translate.google.com" class="app-item">
        <img src="https://upload.wikimedia.org/wikipedia/commons/d/d7/Google_Translate_logo.svg" alt="ترجمة">
        <span>ترجمة</span>
      </a>
      <a href="https://calendar.google.com" class="app-item">
        <img src="https://upload.wikimedia.org/wikipedia/commons/a/a5/Google_Calendar_icon_%282020%29.svg" alt="التقويم">
        <span>التقويم</span>
      </a>
    </div>
  </div>

  <img src="https://lh3.googleusercontent.com/a/default-user=s64-c" class="profile-img" alt="Profile">
</header>

<div class="logo">
  <span class="blue">j</span><span class="red">o</span><span class="yellow">o</span><span class="blue">j</span><span class="green">l</span><span class="red">e</span>
</div>

<div class="search-box">
  <div class="search-wrapper">

    <!-- زر البحث -->
    <button class="icon-btn" onclick="goToResults()" title="بحث">
      <svg viewBox="0 0 24 24">
        <circle cx="11" cy="11" r="7"></circle>
        <line x1="16.65" y1="16.65" x2="22" y2="22"></line>
      </svg>
    </button>

    <!-- input -->
    <input
      id="searchInput"
      type="text"
      placeholder="ابحث في الويب..."
      onkeydown="if(event.key==='Enter')goToResults()"
    />

    <!-- بحث صوتي -->
    <button class="icon-btn" onclick="voiceSearch()" title="بحث صوتي">
      <svg viewBox="0 0 24 24">
        <path d="M12 14a3 3 0 0 0 3-3V5a3 3 0 0 0-6 0v6a3 3 0 0 0 3 3z"/>
        <path d="M19 11a7 7 0 0 1-14 0"/>
        <line x1="12" y1="18" x2="12" y2="22"/>
        <line x1="8" y1="22" x2="16" y2="22"/>
      </svg>
    </button>

    <!-- بحث بالصورة -->
    <button class="icon-btn" onclick="imageSearch()" title="بحث بالصورة">
      <svg viewBox="0 0 24 24">
        <rect x="3" y="5" width="18" height="14" rx="2"/>
        <circle cx="9" cy="10" r="2"/>
        <path d="M21 15l-5-5L5 21"/>
      </svg>
    </button>

    <input type="file" id="imageInput" accept="image/*" hidden />

  </div>
</div>
<script>
function toggleApps(event) {
    event.stopPropagation();
    const menu = document.getElementById('appsMenu');
    if (menu.style.display === 'grid') {
        menu.style.display = 'none';
    } else {
        menu.style.display = 'grid';
    }
}

window.onclick = function(event) {
    const menu = document.getElementById('appsMenu');
    if (!event.target.closest('.apps-container')) {
        menu.style.display = 'none';
    }
}
function goToResults(query = null) {
  const q = query || document.getElementById("searchInput").value.trim();
  if (!q) return;

  window.location.href = `results.html?q=${encodeURIComponent(q)}`;
}

function voiceSearch() {
  if (!("webkitSpeechRecognition" in window)) {
    alert("المتصفح لا يدعم البحث الصوتي");
    return;
  }

  const recognition = new webkitSpeechRecognition();
  recognition.lang = "ar-SA";
  recognition.start();

  recognition.onresult = function (event) {
    const text = event.results[0][0].transcript;
    document.getElementById("searchInput").value = text;
    goToResults(text);
  };
}

function imageSearch() {
  document.getElementById("imageInput").click();
}

document.getElementById("imageInput").addEventListener("change", function () {
  const file = this.files[0];
  if (!file) return;

  window.location.href = "results.html?image=1";
});
</script>

<script>
function handleEnter(e) {
  if (e.key === 'Enter') {
    e.preventDefault();
    const query = document.getElementById("searchInput").value;
    if (!query) return;
    
    window.location.href = `results.html?q=${encodeURIComponent(query)}`;
  }
}
</script>

  <div id="suggestions"></div>
</div>

<div id="results"></div>

<div class="shortcuts" id="shortcuts">
  <div class="shortcut" onclick="addShortcut()"><div class="shortcut-circle">+</div><div>إضافة اختصار</div></div>
  <div class="shortcut" onclick="copyLink()"><div class="shortcut-circle">S</div><div>مشاركة</div></div>
  <div class="shortcut" onclick="window.open('https://chrome.google.com/webstore', '_blank')">
    <div class="shortcut-circle"><img src="https://ssl.gstatic.com/gb/images/bar/al-icon.png" alt="icon"></div><div>السوق الإلكتروني</div>
  </div>
</div>

<div class="customize" onclick="openCustomizeModal()">
  <svg width="20" height="20" viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" fill="#5f6368"></path></svg>
  تخصيص joojle
</div>

<div id="customizeModal" class="modal">
  <div class="modal-content">
    <h3>تخصيص joojle</h3>
    
<div class="customize-option">
  <label>لون الخلفية:</label>
  <input type="color" id="bgColorPicker" value="#ffffff" onchange="updateTheme()">
</div>

<div class="customize-option">
  <label>لون النصوص:</label>
  <input type="color" id="textColorPicker" value="#000000" onchange="updateTheme()">
</div>
    <div class="customize-option">
      <label>رابط صورة خلفية:</label>
      <input type="text" id="bgImageUrl" class="input-style" placeholder="https://..." onchange="updateTheme()">
    </div>

    <div class="customize-option">
      <label>تحميل صورة من جهازك:</label>
      <input type="file" id="bgImageFile" accept="image/*" class="input-style" onchange="handleFileUpload(this)">
    </div>

    <button class="close-modal" onclick="closeCustomizeModal()">حفظ وإغلاق</button>
    <button onclick="resetTheme()" style="background:none; border:none; color:#ea4335; cursor:pointer; width:100%; margin-top:10px; font-size:12px;">إلغاء المظهر المخصص</button>
  </div>
</div>
<script>
let uploadedImageData = ""; 

function openCustomizeModal() { document.getElementById('customizeModal').style.display = 'block'; }
function closeCustomizeModal() { document.getElementById('customizeModal').style.display = 'none'; }

function handleFileUpload(input) {
    const file = input.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            uploadedImageData = e.target.result;
            document.getElementById('bgImageUrl').value = ""; 
            updateTheme();
        };
        reader.readAsDataURL(file);
    }
}

function updateTheme() {
    const bgColor = document.getElementById('bgColorPicker').value;
    const textColor = document.getElementById('textColorPicker').value;
    const bgUrl = document.getElementById('bgImageUrl').value.trim();
    
    const finalBgImage = uploadedImageData || (bgUrl ? `url('${bgUrl}')` : "");

    document.body.style.backgroundColor = bgColor;
    if (finalBgImage) {
        document.body.style.backgroundImage = finalBgImage.startsWith('data') ? `url('${finalBgImage}')` : finalBgImage;
        document.body.style.backgroundSize = "cover";
        document.body.style.backgroundAttachment = "fixed";
        document.body.style.backgroundPosition = "center";
    } else {
        document.body.style.backgroundImage = "none";
    }

    document.querySelectorAll('header a').forEach(a => {
        a.style.setProperty('color', textColor, 'important');
    });

    document.querySelectorAll('.shortcut div').forEach(div => {
        if (!div.classList.contains('shortcut-circle')) {
            div.style.setProperty('color', textColor, 'important');
        }
    });

    const settings = { bgColor, textColor, bgUrl, uploadedImageData };
    localStorage.setItem('joojleTheme', JSON.stringify(settings));
}

window.addEventListener('DOMContentLoaded', () => {
    const saved = localStorage.getItem('joojleTheme');
    if (saved) {
        const s = JSON.parse(saved);
        document.getElementById('bgColorPicker').value = s.bgColor || "#ffffff";
        document.getElementById('textColorPicker').value = s.textColor || "#202124";
        document.getElementById('bgImageUrl').value = s.bgUrl || "";
        uploadedImageData = s.uploadedImageData || "";
        updateTheme();
    }
});

function resetTheme() {
    if(confirm("هل تريد العودة للمظهر الأصلي؟")) {
        localStorage.removeItem('joojleTheme');
        location.reload();
    }
}
function copyLink(){navigator.clipboard.writeText(window.location.href).then(()=>{alert("تم نسخ الرابط إلى الحافظة!");});}

function createShortcutElement(name,url){
  const div=document.createElement("div"); div.className="shortcut"; div.onclick=()=>window.open(url,"_blank");
  const circle=document.createElement("div"); circle.className="shortcut-circle"; circle.textContent=name.charAt(0).toUpperCase();
  const label=document.createElement("div"); label.textContent=name;
  const del=document.createElement("button"); del.className="delete-btn"; del.textContent="×"; del.title="حذف";
  del.onclick=(e)=>{ e.stopPropagation(); if(confirm(`هل تريد حذف "${name}"؟`)){ div.remove(); let saved=JSON.parse(localStorage.getItem("shortcuts")||"[]"); saved=saved.filter(s=>s.name!==name||s.url!==url); localStorage.setItem("shortcuts",JSON.stringify(saved)); } };
  div.appendChild(circle); div.appendChild(label); div.appendChild(del);
  return div;
}

function addShortcut(){
  const name=prompt("ما اسم الموقع؟"); if(!name)return;
  const url=prompt("ما رابط الموقع؟"); if(!url||!url.startsWith("http")){ alert("يرجى إدخال رابط صحيح يبدأ بـ http"); return; }
  const container=document.getElementById("shortcuts"); const shortcut=createShortcutElement(name,url); container.insertBefore(shortcut,container.firstChild);
  let saved=JSON.parse(localStorage.getItem("shortcuts")||"[]"); saved.push({name,url}); localStorage.setItem("shortcuts",JSON.stringify(saved));
}

window.addEventListener("DOMContentLoaded",()=>{
  const saved=JSON.parse(localStorage.getItem("shortcuts")||"[]"); const container=document.getElementById("shortcuts");
  saved.reverse().forEach(({name,url})=>{ const shortcut=createShortcutElement(name,url); container.insertBefore(shortcut,container.firstChild); });
});
</script>

<script>
const API_BASE = ""; 

async function search(){
  const q=document.getElementById("searchInput").value;
  if(!q)return;

  const res=await fetch(`${API_BASE}/api/search?q=${encodeURIComponent(q)}`);
  const data=await res.json();

  document.getElementById("results").innerHTML=data.map(r=>`
    <div class="result-item">
      ${r.image ? `<img src="${r.image}" alt="image">` : ""}
      <a href="${r.link}" target="_blank" style="color:#1a0dab;font-size:18px;text-decoration:none">${r.title}</a>
      <p style="color:#4d5156">${r.snippet}</p>
    </div>
  `).join("");
}

async function autocomplete(){
  const q=document.getElementById("searchInput").value;
  if(q.length<2)return;

  const res=await fetch(`${API_BASE}/api/autocomplete?q=${q}`);
  const data=await res.json();

  document.getElementById("suggestions").innerHTML=`
    <div style="background:#fff;border:1px solid #ddd;border-radius:10px">
      ${data.map(s=>`<div onclick="selectSuggestion('${s}')"
        style="padding:8px;cursor:pointer">${s}</div>`).join("")}
    </div>
  `;
}

function selectSuggestion(text){ document.getElementById("searchInput").value=text; document.getElementById("suggestions").innerHTML=""; search(); }

async function summarize(content){
  const res=await fetch(`${API_BASE}/api/ai/summary`,{
    method:"POST",
    body:JSON.stringify({content:decodeURIComponent(content)})
  });
  const data=await res.json();
  alert("✨ التلخيص:\n\n"+data.summary);
}
let classifier;
async function loadModel() {
    if (typeof ml5 !== 'undefined') {
        classifier = await ml5.imageClassifier('MobileNet');
    }
}
loadModel();

function imageSearch() {
    document.getElementById("imageInput").click();
}

document.getElementById("imageInput").addEventListener("change", function (e) {
    const file = e.target.files[0];
    if (!file) return;

    const searchInput = document.getElementById("searchInput");
    searchInput.value = "جاري تحليل الصورة...";

    const reader = new FileReader();
    reader.onload = function (event) {
        const imgElement = new Image();
        imgElement.src = event.target.result;

        imgElement.onload = async () => {
            try {
                if (!classifier) classifier = await ml5.imageClassifier('MobileNet');

                const results = await classifier.classify(imgElement);
                
                let foundObject = results[0].label.split(',')[0].trim();

                window.location.href = `images.html?q=${encodeURIComponent(foundObject)}`;

            } catch (err) {
                console.error("خطأ في التحليل:", err);
                alert("عذراً، لم نتمكن من التعرف على محتوى الصورة.");
                searchInput.value = "";
            }
        };
    };
    reader.readAsDataURL(file);
});
</script>

</body>
</html>
